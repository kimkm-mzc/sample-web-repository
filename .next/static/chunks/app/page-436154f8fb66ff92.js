(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5099:function(e,t,s){Promise.resolve().then(s.bind(s,8488))},8488:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Home}});var r=s(7437),a=s(2265),l=s(4829);let n=["인공지능","암호화폐","기후변화","우주탐사","전기차","메타버스","바이오테크","반도체"];function SearchForm(e){let{onSearch:t,loading:s}=e,[l,i]=(0,a.useState)(""),handleTopicClick=e=>{s||(i(e),t(e))};return(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-responsive",children:[(0,r.jsx)("form",{onSubmit:e=>{e.preventDefault();let s=l.trim();if(s){let e=s.replace(/<[^>]*>/g,"");t(e)}},className:"mb-responsive",children:(0,r.jsxs)("div",{className:"flex-responsive",children:[(0,r.jsx)("input",{type:"text",value:l,onChange:e=>{let t=e.target.value,s=t.replace(/<script[^>]*>.*?<\/script>/gi,"").replace(/<[^>]*>/g,"");i(s)},placeholder:"관심 있는 주제를 입력하세요... (예: 인공지능, 암호화폐)",className:"search-input flex-1 min-w-0",disabled:s,maxLength:100,autoComplete:"off",spellCheck:"false",pattern:"[^<>]*",title:"HTML 태그는 사용할 수 없습니다"}),(0,r.jsx)("button",{type:"submit",disabled:s||!l.trim(),className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap sm:min-w-[120px]",children:"뉴스 검색"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm sm:text-base font-medium text-gray-700 mb-3 sm:mb-4",children:"인기 주제"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:n.map(e=>(0,r.jsx)("button",{onClick:()=>handleTopicClick(e),disabled:s,className:"px-3 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm bg-gray-100 hover:bg-primary-50 hover:text-primary-600 rounded-full transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed touch-manipulation min-h-[44px] flex items-center justify-center",children:e},e))})]})]})}function LoadingSpinner(){return(0,r.jsx)("div",{className:"flex justify-center items-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})}function formatDate(e){let t=new Date(e),s=new Date,r=Math.abs(s.getTime()-t.getTime()),a=Math.ceil(r/864e5);return 1===a?"1일 전":a<7?"".concat(a,"일 전"):t.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}function NewsCard(e){let{news:t,onSummarize:s,isLoading:a}=e;return(0,r.jsxs)("article",{className:"news-card",children:[(0,r.jsxs)("header",{className:"flex flex-col xs:flex-row xs:justify-between xs:items-start mb-4 gap-2",children:[(0,r.jsx)("h2",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 flex-1 leading-tight min-w-0",children:t.title}),(0,r.jsx)("span",{className:"text-xs sm:text-sm text-gray-500 font-medium whitespace-nowrap self-start xs:self-auto shrink-0",children:t.source})]}),(0,r.jsx)("p",{className:"text-gray-700 mb-4 text-sm sm:text-base lg:text-lg line-clamp-3 leading-relaxed",children:t.description}),!t.summary&&!a&&(0,r.jsx)("button",{onClick:()=>s(t.id),className:"mb-4 px-3 sm:px-4 py-2 sm:py-2.5 bg-primary-50 hover:bg-primary-100 active:bg-primary-200 text-primary-700 rounded-lg transition-colors duration-200 text-xs sm:text-sm font-medium w-full xs:w-auto touch-manipulation min-h-[44px] flex items-center justify-center",children:"\uD83E\uDD16 AI 요약하기"}),a&&(0,r.jsxs)("div",{className:"mb-4 flex items-center gap-3 p-3 sm:p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)(LoadingSpinner,{}),(0,r.jsx)("span",{className:"text-gray-600 text-xs sm:text-sm",children:"AI 요약 중..."})]}),t.summary&&(0,r.jsxs)("div",{className:"mb-4 p-3 sm:p-4 lg:p-5 bg-blue-50 border-l-4 border-blue-400 rounded-lg",children:[(0,r.jsx)("h3",{className:"text-xs sm:text-sm lg:text-base font-semibold text-blue-800 mb-2",children:"\uD83E\uDD16 AI 요약"}),(0,r.jsx)("p",{className:"text-blue-700 text-xs sm:text-sm lg:text-base leading-relaxed",children:t.summary})]}),(0,r.jsxs)("footer",{className:"flex flex-col xs:flex-row xs:justify-between xs:items-center gap-2 text-xs sm:text-sm text-gray-500 pt-2 border-t border-gray-100",children:[(0,r.jsx)("time",{dateTime:t.publishedAt,children:formatDate(t.publishedAt)}),t.url&&(0,r.jsx)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700 active:text-primary-800 font-medium self-start xs:self-auto transition-colors duration-200 touch-manipulation",children:"원문 보기 →"})]})]})}function Toast(e){let{message:t,type:s,duration:l=5e3,onClose:n}=e,[i,c]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=setTimeout(()=>{c(!1),setTimeout(n,300)},l);return()=>clearTimeout(e)},[l,n]),(0,r.jsx)("div",{className:(()=>{let e="fixed top-4 right-4 z-50 max-w-sm w-full bg-white rounded-lg shadow-lg border-l-4 p-4 transition-all duration-300 transform";if(!i)return"".concat(e," translate-x-full opacity-0");switch(s){case"success":return"".concat(e," border-green-500");case"error":return"".concat(e," border-red-500");case"warning":return"".concat(e," border-yellow-500");case"info":return"".concat(e," border-blue-500");default:return"".concat(e," border-gray-500")}})(),role:"alert","aria-live":"error"===s?"assertive":"polite","aria-atomic":"true",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("span",{className:"text-lg","aria-hidden":"true",children:(()=>{switch(s){case"success":return"✅";case"error":return"❌";case"warning":return"⚠️";default:return"ℹ️"}})()})}),(0,r.jsx)("div",{className:"ml-3 flex-1",children:(0,r.jsx)("p",{className:"text-sm font-medium ".concat((()=>{switch(s){case"success":return"text-green-800";case"error":return"text-red-800";case"warning":return"text-yellow-800";case"info":return"text-blue-800";default:return"text-gray-800"}})()),children:t})}),(0,r.jsx)("div",{className:"ml-4 flex-shrink-0",children:(0,r.jsx)("button",{onClick:()=>{c(!1),setTimeout(n,300)},className:"inline-flex text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 rounded p-1","aria-label":"알림 닫기",type:"button",children:(0,r.jsx)("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})})]})})}function useToast(){let[e,t]=(0,a.useState)([]),s=(0,a.useCallback)(e=>{let s=Date.now().toString(),a={...e,id:s};t(e=>[...e,a]),setTimeout(()=>{r(s)},e.duration||5e3)},[]),r=(0,a.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]),l=(0,a.useCallback)(()=>{t([])},[]),n=(0,a.useCallback)((e,t)=>{s({message:e,type:"success",duration:t})},[s]),i=(0,a.useCallback)((e,t)=>{s({message:e,type:"error",duration:t})},[s]),c=(0,a.useCallback)((e,t)=>{s({message:e,type:"warning",duration:t})},[s]),o=(0,a.useCallback)((e,t)=>{s({message:e,type:"info",duration:t})},[s]);return{toasts:e,addToast:s,removeToast:r,clearAllToasts:l,showSuccess:n,showError:i,showWarning:c,showInfo:o}}let i=[/<script[^>]*>.*?<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/<iframe[^>]*>.*?<\/iframe>/gi,/data:text\/html/gi,/vbscript:/gi,/<object[^>]*>.*?<\/object>/gi,/<embed[^>]*>.*?<\/embed>/gi,/<link[^>]*>/gi,/<meta[^>]*>/gi],c=[/(\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|UNION)\b)/gi,/(--|\/\*|\*\/|;)/g,/(\bOR\b|\bAND\b).*?(\b=\b|\b<\b|\b>\b)/gi];function containsDangerousPatterns(e){return!!e&&"string"==typeof e&&(i.some(t=>t.test(e))||c.some(t=>t.test(e)))}function sanitizeText(e){return e&&"string"==typeof e?e.replace(/<[^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").trim():""}function validateSearchTopic(e){if(!e||"string"!=typeof e)return{isValid:!1,error:"검색어를 입력해주세요."};let t=e.trim();if(0===t.length)return{isValid:!1,error:"검색어를 입력해주세요."};if(t.length<2)return{isValid:!1,error:"검색어는 2글자 이상 입력해주세요."};if(t.length>100)return{isValid:!1,error:"검색어는 100글자 이하로 입력해주세요."};if(containsDangerousPatterns(t))return{isValid:!1,error:"안전하지 않은 문자가 포함되어 있습니다."};let s=sanitizeText(t);return 0===s.length?{isValid:!1,error:"유효한 검색어를 입력해주세요."}:{isValid:!0,sanitizedTopic:s}}function getUserFriendlyErrorMessage(e,t){var s;if(!e)return"알 수 없는 오류가 발생했습니다.";if("ECONNABORTED"===e.code)return"요청 시간이 초과되었습니다. 네트워크 연결을 확인해주세요.";if("ENOTFOUND"===e.code||"ECONNREFUSED"===e.code)return"서비스에 연결할 수 없습니다. 잠시 후 다시 시도해주세요.";let r=null===(s=e.response)||void 0===s?void 0:s.status;return 400===r?"요청 형식이 올바르지 않습니다.":401===r?"search"===t?"API 인증에 실패했습니다.":"AI 서비스 인증에 실패했습니다.":403===r?"API 접근이 거부되었습니다.":429===r?"API 할당량이 초과되었습니다. 잠시 후 다시 시도해주세요.":503===r?"search"===t?"뉴스 서비스가 일시적으로 사용할 수 없습니다.":"AI 서비스가 일시적으로 사용할 수 없습니다.":r>=500?"서버에 일시적인 문제가 발생했습니다. 잠시 후 다시 시도해주세요.":"search"===t?"뉴스를 가져오는 중 오류가 발생했습니다.":"요약 생성 중 오류가 발생했습니다."}function Home(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!1),[i,c]=(0,a.useState)(""),[o,m]=(0,a.useState)(new Set),[d,x]=(0,a.useState)({}),{toasts:u,removeToast:p,clearAllToasts:g,showSuccess:h,showError:f,showWarning:b,showInfo:y}=useToast(),handleSearch=async function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=validateSearchTopic(e);if(!r.isValid){b(r.error);return}let a=r.sanitizedTopic;s||(g(),x(e=>({...e,search:0}))),n(!0),c(a);try{let e=await l.Z.post("/api/news",{topic:a},{timeout:12e3,headers:{"Content-Type":"application/json"}});e.data.success?(t(e.data.news),x(e=>({...e,search:0})),e.data.news.length>0?h('"'.concat(a,'" 관련 뉴스 ').concat(e.data.news.length,"개를 찾았습니다.")):y('"'.concat(a,'"에 대한 뉴스를 찾을 수 없습니다. 다른 키워드로 검색해보세요.'))):(console.error("뉴스 검색 실패:",e.data.error),f(e.data.error||"뉴스를 가져오는 중 오류가 발생했습니다."))}catch(n){var i;console.error("뉴스 검색 에러:",n);let e=d.search||0,t=e<2&&!s,r=getUserFriendlyErrorMessage(n,"search"),l=["ECONNABORTED","ENOTFOUND","ECONNREFUSED"].includes(n.code)||[503,500,502,504].includes(null===(i=n.response)||void 0===i?void 0:i.status)||!navigator.onLine;t&&l?(f("".concat(r," 자동으로 다시 시도합니다... (").concat(e+1,"/3)")),x(t=>({...t,search:e+1})),setTimeout(()=>{handleSearch(a,!0)},3e3)):f(r)}finally{n(!1)}},handleSummarize=async function(s){var r,a,n;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=e.find(e=>e.id===s);if(!c){f("뉴스 정보를 찾을 수 없습니다.");return}if(c.summary){y("이미 요약이 완료된 뉴스입니다.");return}if(o.has(s)){b("이미 요약을 진행 중입니다.");return}if(!(null===(r=c.title)||void 0===r?void 0:r.trim())||!(null===(a=c.description)||void 0===a?void 0:a.trim())){f("요약할 수 있는 충분한 내용이 없습니다.");return}m(e=>new Set(Array.from(e).concat(s))),i||x(e=>({...e,[s]:0}));try{let e=await l.Z.post("/api/summarize",{title:c.title,description:c.description,content:c.content},{timeout:35e3,headers:{"Content-Type":"application/json"}});e.data.success?(t(t=>t.map(t=>t.id===s?{...t,summary:e.data.summary}:t)),x(e=>({...e,[s]:0})),h("AI 요약이 완료되었습니다!")):(console.error("요약 실패:",e.data.error),f(e.data.error||"요약 생성 중 오류가 발생했습니다."))}catch(l){console.error("요약 에러:",l);let e=d[s]||0,t=e<2&&!i,r=getUserFriendlyErrorMessage(l,"summarize"),a=["ECONNABORTED","ENOTFOUND","ECONNREFUSED"].includes(l.code)||[503,500,502,504].includes(null===(n=l.response)||void 0===n?void 0:n.status)||!navigator.onLine;t&&a?(f("".concat(r," 자동으로 다시 시도합니다... (").concat(e+1,"/3)")),x(t=>({...t,[s]:e+1})),setTimeout(()=>{handleSummarize(s,!0)},5e3)):f(r)}finally{m(e=>{let t=new Set(e);return t.delete(s),t})}};return(0,r.jsxs)(r.Fragment,{children:[u.map(e=>(0,r.jsx)(Toast,{message:e.message,type:e.type,duration:e.duration,onClose:()=>p(e.id)},e.id)),(0,r.jsxs)("div",{className:"container mx-auto container-responsive py-6 sm:py-8 lg:py-12 max-w-4xl min-h-screen",children:[(0,r.jsxs)("header",{className:"text-center mb-responsive",children:[(0,r.jsx)("h1",{className:"text-3xl sm:text-4xl lg:text-5xl xl:text-6xl font-bold text-gray-900 mb-3 sm:mb-4 lg:mb-6",children:"\uD83E\uDD16 AI 뉴스 브리핑"}),(0,r.jsx)("p",{className:"text-base sm:text-lg lg:text-xl text-gray-600 px-2 max-w-2xl mx-auto leading-relaxed",children:"관심 있는 주제의 최신 뉴스를 검색하고 AI가 요약해드립니다"})]}),(0,r.jsx)("section",{className:"mb-responsive",children:(0,r.jsx)(SearchForm,{onSearch:handleSearch,loading:s})}),s&&(0,r.jsxs)("section",{className:"text-center py-8 sm:py-12 lg:py-16",children:[(0,r.jsx)(LoadingSpinner,{}),(0,r.jsxs)("p",{className:"mt-4 text-gray-600 text-sm sm:text-base lg:text-lg px-4 max-w-md mx-auto",children:['"',i,'" 관련 뉴스를 검색하고 있습니다...']})]}),!s&&e.length>0&&(0,r.jsxs)("main",{children:[(0,r.jsxs)("h2",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900 mb-4 sm:mb-6 lg:mb-8 px-2",children:['"',i,'" 검색 결과 (',e.length,"개)"]}),(0,r.jsx)("div",{className:"space-y-4 sm:space-y-6 lg:space-y-8",children:e.map(e=>(0,r.jsx)(NewsCard,{news:e,onSummarize:handleSummarize,isLoading:o.has(e.id)},e.id))})]}),!s&&i&&0===e.length&&(0,r.jsx)("section",{className:"text-center py-8 sm:py-12 lg:py-16",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto px-4",children:[(0,r.jsx)("div",{className:"text-6xl sm:text-7xl lg:text-8xl mb-4 opacity-50",children:"\uD83D\uDCF0"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm sm:text-base lg:text-lg",children:['"',i,'"에 대한 뉴스를 찾을 수 없습니다.']}),(0,r.jsx)("p",{className:"text-gray-500 text-xs sm:text-sm mt-2",children:"다른 키워드로 검색해보세요."})]})}),!s&&!i&&(0,r.jsx)("section",{className:"text-center py-8 sm:py-12 lg:py-16",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto px-4",children:[(0,r.jsx)("div",{className:"text-6xl sm:text-7xl lg:text-8xl mb-4 opacity-50",children:"\uD83D\uDD0D"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm sm:text-base lg:text-lg",children:"관심 있는 주제를 검색해보세요!"}),(0,r.jsx)("p",{className:"text-gray-500 text-xs sm:text-sm mt-2",children:"인기 주제 버튼을 클릭하거나 직접 입력해보세요."})]})})]})]})}}},function(e){e.O(0,[737,971,472,744],function(){return e(e.s=5099)}),_N_E=e.O()}]);